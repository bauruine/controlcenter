<%= render :partial => "header", :object => {
  "title" => "System " + @system.name,
  "actions" =>[{
    "icon" => "arrow-left",
    "text" => "",
    "path" => systems_path
  }, {
    "icon" => "pencil",
    "text" => "",
    "path" => edit_system_path(@system)
  }, {
    "icon" => "remove",
    "text" => "",
    "path" => @system,
    "method" => :delete,
    "confirm" => "Are you sure you want to delete this system?"
  }]
} %>

<ul class="properties col_6">
  <li>
    <p>
      <span class="property">Name</span>
      <span class="value"><%= @system.name %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">URN</span>
      <span class="value"><%= @system.urn %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">OS</span>
      <span class="value"><%= @system.os %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">Reboot Required?</span>
      <span class="value"><%= @system.reboot_required %></span>
    </p>
  </li>
</ul>
<ul class="properties col_6">
  <li>
    <p>
      <span class="property">Address</span>
      <span class="value"><%= @system.address %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">Last seen</span>
      <span class="value"><%= @system.last_seen %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">System Group</span>
      <span class="value"><%= @system.system_group ? (link_to @system.system_group.name, @system.system_group) : "-" %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">Updates</span>
      <span class="value"><%= @system_updates.length %></span>
    </p>
  </li>
</ul>

<%= form_tag({controller: "jobs", action: "create"}) do %>
  <% if @system_updates.length %>
  <table class="availableUpdates">
    <thead>
      <tr>
        <th>Package</th>
        <th>Candidate Version</th>
        <th>System update state</th>
        <th>Install?</th>
      </tr>
    </thead>
    <tbody>
      <% @paginated_system_updates.each do |system_update| %>
        <tr>
          <td><%= link_to system_update.package_version.package.name, system_update.package_version.package %></td>
          <td><%= link_to system_update.package_version.version, system_update.package_version %></td>
          <td><%= system_update.concrete_package_state.name %></td>
          <td><%= check_box_tag "updates[]", system_update.id, false, class: 'checkboxInstallUpdate' %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <%= hidden_field_tag(:system_id, @system.id) %>

  <div class="actions">
    <%= submit_tag "Create Job for Selected", :id=>"createJobBtn", :name => 'specific' %>
    <%= submit_tag "Create Job for all", :id=>"createJobBtnForAll", :name => 'all' %>
  </div>

  <div class="digg_pagination">
    <div class="page_info">
      <%= page_entries_info @paginated_system_updates %>
    </div>
    <%= will_paginate @paginated_system_updates, :container => false %>
  </div>

  <% end %>
<% end %>
