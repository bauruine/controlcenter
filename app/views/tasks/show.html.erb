<%= render :partial => "header", :object => {
  "title" => "Task",
  "actions" =>[{
    "icon" => "arrow-left",
    "text" => "",
    "path" => tasks_path
  }, {
    "icon" => "pencil",
    "text" => "",
    "path" => edit_task_path(@task)
  }, {
    "icon" => "remove",
    "text" => "",
    "path" => @task,
    "method" => :delete,
    "confirm" => "Are you sure you want to delete this task?"
  }]
} %>

<ul class="properties col_6">
  <li>
    <p>
      <span class="property">Task state</span>
      <span class="value"><%= @task.task_state.name if @task.task_state %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">Task execution</span>
      <span class="value"><%= @task.task_execution %></span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">System</span>
      <span class="value">
        <% if @task.system_updates.length > 0 %>
          <%= link_to @task.system_updates.first.system.name, @task.system_updates.first.system %>
        <% end %>
      </span>
    </p>
  </li>
  <li>
    <p>
      <span class="property">Job</span>
      <span class="value"><%= link_to @task.job.id, @task.job %></span>
    </p>
  </li>
</ul>

<% if @task.system_updates.length > 0 %>
  <table>
    <thead>
      <tr>
        <th>Package</th>
        <th>Candidate Version</th>
        <th>System update state</th>
      </tr>
    </thead>
    <tbody>
      <% @paginated_system_updates.each do |system_update| %>
        <tr>
          <td><%= link_to system_update.package_update.package.name, system_update.package_update.package %></td>
          <td><%= link_to system_update.package_update.candidate_version, system_update.package_update %></td>
          <td><%= system_update.system_update_state.name %></td>
        </tr>
      <% end %>
    </tbody>
  </table>

  <div class="digg_pagination">
    <div class="page_info">
      <%= page_entries_info @paginated_system_updates %>
    </div>
    <%= will_paginate @paginated_system_updates, :container => false %>
  </div>
<% end %>

<div class="floatFix"></div>
